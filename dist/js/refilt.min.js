/**
 * refilt - For filtering and sorting products based on a JSON object.
 * @version v3.1.6
 * @link http://coalescecreate.com
 * @author richard@coalescecreate.com Coalesce Create
 * @license MIT
 */
!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window):e(jQuery,window)}(function(e,t){var s={init:function(){var i=this;i.set.debug===!0&&(0===i.find("."+i.set.groupClass).length&&console.log("no element with groupClass (."+i.set.groupClass+") found"),0===i.find("#"+i.set.itemContId).length&&console.log("no items container with itemContId (#"+i.set.itemContId+") found")),i.addClass("refilt--loading refilt--init"),i.set.currentHash=t.location.hash,i.set.filterOptions.paging&&(i.set.paging=i.set.filterOptions.paging),"#"===i.set.currentHash||""===i.set.currentHash?i.set.currentHash="":(i.addClass("refilt--filtered"),i.set.updateWHash!==!1&&e("."+i.set.updateWHash).each(function(){var t=e(this).attr("href");e(this).attr("href",t+i.set.currentHash)})),e.ajax({url:i.set.url,type:"GET",cache:!0,dataType:"JSON",success:function(a){i.filter=a,i.set.debug===!0&&console.log("var $this.filter",e.extend({},i.filter)),s.preFilter.apply(i),s.buildFilter.apply(i),s.enableEvents.apply(i),i.filter.settings.limit>0&&(i.set.limit=i.filter.settings.limit),i.set.pages=Math.ceil(i.set.initItems.length/i.set.limit),s.updateFilterObjFromHash({data:{"this":i,init:!0}}),!i.set.historyCategories&&i.set.updateLocation&&e(t).on("hashchange",{"this":i,init:!1},s.updateFilterObjFromHash)}})},preFilter:function(){var t=this,i=[],a=[],r=[],l=0,n=0,o=null,d=null,c=null,p="",f="",u=!1,h=!1;if(t.set.initItems=e.extend(!0,[],t.filter.products),void 0!==t.set.category&&"/"!==t.set.category){if(0===t.set.category.indexOf("/")&&(t.set.category=t.set.category.slice(1)),o=t.filter.filter.categories,products=t.filter.products,d=t.filter.settings.filter,c=t.filter.filter,u=t.set.category===t.set.newsURI,h=t.set.category===t.set.saleURI,t.set.isCampaignURL=u||h,t.set.isCampaignURL)for(l=0;l<products.length;l++)u&&products[l].price.newProduct&&(a[a.length]=products[l].id),h&&products[l].price.showAsOnSale&&(a[a.length]=products[l].id);else{if(t.set.historyCategories){var g=t.find("."+t.set.groupClass),v={};g.each(function(){var s=e(this).attr("id");if(0===s.indexOf("categories_")){var i=s.replace("categories_","").split("_");0===t.set.category.indexOf(i[0])&&(v[s]=[])}}),0===Object.keys(v).length?t.set.historyCategories=!1:(Object.keys(v).forEach(function(e){Object.keys(o).forEach(function(s){var i=s.split("/"),r=!1;void 0!==v["categories_"+i[0]+"_"+i[1]+"_"+i[2]]?"categories_"+i[0]+"_"+i[1]+"_"+i[2]===e&&(r="categories_"+i[0]+"_"+i[1]+"_"+i[2]):r||void 0===v["categories_"+i[0]+"_"+i[1]]?r||void 0===v["categories_"+i[0]]||"categories_"+i[0]===e&&(r="categories_"+i[0]):"categories_"+i[0]+"_"+i[1]===e&&(r="categories_"+i[0]+"_"+i[1]),-1===Object.keys(v).indexOf("categories_"+i.join("_"))?r!==!1&&(void 0===t.filter.filter[r]&&(t.filter.filter[r]={}),void 0===t.set.filterCategories[r]&&(t.set.filterCategories[r]=[]),t.filter.filter[r][s]=o[s],a=Array.prototype.concat.apply(a,o[s]),t.set.filterCategories[r].push(s)):r!==!1&&(a=Array.prototype.concat.apply(a,o[s]))})}),delete t.filter.filter.categories)}if(!t.set.historyCategories){var m="^"+t.set.category+"$";for(var y in o){t.set.alsoMatchChildrenCategories&&(m="^"+t.set.category);var C=new RegExp(m);C.test(y)&&(a[l]=o[y],l++)}}}for(i=Array.prototype.concat.apply([],a),i=s.unique(i),t.set.filterProducts!==!1&&(a=[],products.forEach(function(e){for(var s=0;s<t.set.filterProducts.length;s++)t.set.filterProducts[s][1]&&parseInt(e[t.set.filterProducts[s][0]],10)===parseInt(t.set.filterProducts[s][1],10)?(a[n]=e.id,n++):t.set.filterProducts[s][1]||void 0!==e[t.set.filterProducts[s][0]]||(a[n]=e.id,n++)}),i=0===i.length?a:s.intersect(i,a)),t.set.relevantFilters={},l=0;l<d.length;l++){f=d[l][0].replace(/_\d$/,""),p=c[f];for(var b in p)a=[],r=[],a=s.intersect(i,p[b]),a.length>0&&(void 0===t.set.relevantFilters[f]&&(t.set.relevantFilters[f]={}),t.set.relevantFilters[f][b]=a)}t.set.initItems=void 0!==t.filter.related?s.relatedToItems.apply(t,[i,!0]):s.keysToItems.apply(t,[i])}t.set.initItemsStr=JSON.stringify(t.set.initItems),t.set.currentItems=t.set.initItems.slice(0)},buildFilter:function(){var t=this,i=t.find("."+t.set.groupClass),a="",r="",l={},n="",o=t.filter.settings.filter.length,d=t.set.splitSizes!==!1?"</"+t.set.splitSizes.match(/<([a-z]+)/)[1]+">":"";if(void 0!==t.filter.settings.sort){var c=e("#sort"),p=void 0!==t.filter.settings.sort.init?t.filter.settings.sort.init:"";r=c.data("create"),l=t.set.filterOptions.sort||{};for(var f in t.filter.settings.sort)"init"!==f&&(t.filter.settings.sort[f].asc&&(a+=s.buildFilterTemplate.call(t,r,"sort-"+f+"-asc",'["'+f+'","asc"]',t.filter.settings.sort[f].asc,l)),t.filter.settings.sort[f].dsc&&(a+=s.buildFilterTemplate.call(t,r,"sort-"+f+"-dsc",'["'+f+'","dsc"]',t.filter.settings.sort[f].dsc,l)));void 0!==l.wrapperGroup&&(a=l.wrapperGroup+a+"</"+l.wrapperGroup.match(/<([a-z]+)/)[1]+">"),"fakeSelect"===r&&(t.set.repeatStartFakeSelect&&(a=s.buildFilterTemplate.call(t,"start_"+r,"","",p,l)+a),n=void 0!==l.parentClassNames?" "+l.parentClassNames.join(" "):"",a='<div class="filterControls-value rekaf'+n+'"><span class="rekaf-title">'+p+'</span><ul class="ul-clean rekaf-list">'+a+"</ul></div>"),("select"===r||"multiSelect"===r)&&(a='<select class="filterControls-value"'+("multiSelect"===r?' multiple="multiple"':"")+'><option value="0">'+p+"</option>"+a+"</select>"),c.append(a)}for(var u=0;o>u;u++){var h=t.filter.settings.filter[u][0],g=h.replace(/_\d$/,""),v=t.filter.settings.filter[u][1],m=i.filter("#"+h),y=t.set.relevantFilters||t.filter.filter,C={},b=m.data("max-length")||null,I=0,S="",w="",x=null,O=null,F=null,B="",j=[],k={};a="",r=m.data("create"),l=t.set.filterOptions[h]||{},t.set.sortFiltersAlphabetically&&0!==g.indexOf("categories")&&void 0!==y[g]?Object.keys(y[g]).sort(function(e,s){return void 0!==t.filter.filterDescriptions[g][e].order&&(e=t.filter.filterDescriptions[g][e].order),void 0!==t.filter.filterDescriptions[g][s].order&&(s=t.filter.filterDescriptions[g][s].order),e>s?1:-1}).forEach(function(e){void 0===C[g]&&(C[g]=[]),C[g][e]=y[g][e]}):void 0!==y[g]&&Object.keys(y[g]).forEach(function(e){void 0===C[g]&&(C[g]=[]),C[g][e]=y[g][e]});for(var $ in C[g]){w=$;var A=0===g.indexOf("categories")?"categories":g;if(void 0!==t.filter.filterDescriptions[A]&&void 0!==t.filter.filterDescriptions[A][$]&&(w=t.filter.filterDescriptions[A][$]),("object"==typeof w||-1===w.indexOf("::"))&&"categories"!==g||t.set.historyCategories)t.set.splitSizes!==!1&&"size"===g?(x="size",sizeTables=$.split("_"),O!==sizeTables[0]&&(null!==O&&(a+=t.set.splitSizes+S+d,S=""),O=sizeTables[0]),S+=s.buildFilterTemplate.call(t,r,g+"-"+$,$,w,l)):(tempTplAdditions=e.extend(!0,{},l),t.set.historyCategories&&0===g.indexOf("categories")&&(tempTplAdditions.classNames=l.classNames&&0!==l.classNames.length?l.classNames.concat(["filterControls-value--depth"+$.split("/").length]):["filterControls-value--depth"+$.split("/").length],w=w.split("::").pop()),a+=s.buildFilterTemplate.call(t,r,g+"-"+$,$,w,tempTplAdditions));else{var T=w.split("::");if(0!==$.indexOf(t.set.category)&&!t.set.isCampaignURL)continue;if(j=$.split("/"),void 0!==m.data("depth")){if(F=m.data("depth")-1,void 0===T[F])continue;B=j[F],w=T[F],void 0===k[B]&&(a+=s.buildFilterTemplate.call(t,r,h+"-"+B,B,w,l),k[B]=!0)}else w=T.pop(),x="tree",O!==T.join("")&&(null!==O&&(a+=s.buildFilterTemplate.call(t,"group_"+r,"",S,O,l),S=""),O=T.join("")),S+=s.buildFilterTemplate.call(t,r,g+"-"+$,$,w,l)}I++}null!==O&&(a+="tree"===x?s.buildFilterTemplate.call(t,"group_"+r,"",S,O,l):t.set.splitSizes+S+d),I>b&&null!==b&&(t.set.hideAncestor!==!1?m.closest("."+t.set.hideAncestor).addClass("too-many-options"):m.addClass("too-many-options")),void 0!==l.wrapperGroup&&(a=l.wrapperGroup+a+"</"+l.wrapperGroup.match(/<([a-z]+)/)[1]+">"),"fakeSelect"===r&&(t.set.repeatStartFakeSelect&&(S=s.buildFilterTemplate.call(t,"start_"+r,"",$,v,l)),n=void 0!==l.parentClassNames?" "+l.parentClassNames.join(" "):"",a='<div class="filterControls-value rekaf'+n+'"><span class="rekaf-title">'+v+'</span><ul class="ul-clean rekaf-list">'+S+a+"</ul></div>"),("select"===r||"multiSelect"===r)&&(a='<select name="'+g+'" class="filterControls-value"'+("multiSelect"===r?' multiple="multiple"':"")+'><option value="0">'+v+"</option>"+a+"</select>"),m.append(a)}t.removeClass("refilt--loading refilt--filtered").addClass("refilt--loaded"),void 0!==t.set.afterFilterRendered&&t.set.afterFilterRendered()},buildFilterTemplate:function(e,t,i,a,r){var l=this,n={desc:a},o="",d="",c="",p="",f="",u="",h=!1;for(var g in r)switch(g){case"classNames":o=r[g].join(" ");break;case"background":h=r[g];break;case"attrs":p=" "+r[g].replace("{desc}",a[0]);break;case"wrapper":d=r[g],c="</"+r[g].match(/<([a-z]+)/)[1]+">"}return"object"==typeof a&&(n.desc=a.desc),void 0!==l.set.eachFilterAttrs&&(n=l.set.eachFilterAttrs(n)),u=h?' title="'+n.desc+'"':"",f=h?s.hexOrImage(a,"style",l.set.forceHex,l.set.swatchClass):n.desc,t=t.replace(/\W/g,"-"),"a"===e?d+'<a id="'+t+'" class="'+o+' filterControls-value"'+u+' href="#" data-value=\''+i+"'"+p+">"+f+"</a>"+c:"select"===e||"multiSelect"===e?'<option id="'+t+'" value="'+i+'">'+n.desc+"</option>":"fakeSelect"===e?"<li "+p+u+'><a id="'+t+'" class="'+o+' filterControls-value"'+u+' href="#" data-value=\''+i+"'>"+f+"</a></li>":"radio"===e?d+'<input id="'+t+'" type="radio" class="'+o+' filterControls-value" value="'+i+'" /><label'+u+' for="'+t+'">'+f+"</label>"+c:"checkbox"===e?d+'<input id="'+t+'" type="checkbox" class="'+o+' filterControls-value" value="'+i+'" /><label'+u+' for="'+t+'">'+f+"</label>"+c:"group_select"===e?'<optgroup label="'+n.desc+'">'+i+"</optgroup>":"start_fakeSelect"===e?'<li class="'+o+'"'+p+'><a class="js-remove" href="#">'+n.desc+"</a></li>":""},enableEvents:function(){var i=this,a=null,r={move:!1};a=function(){return r.moved?!1:Math.abs(Math.abs(r.startX)-Math.abs(r.endX))<50&&Math.abs(Math.abs(r.startY)-Math.abs(r.endY))<50},e(t).on({touchstart:function(e){i.set.touch=!0,r.startX=e.originalEvent.targetTouches[0].clientX,r.startY=e.originalEvent.targetTouches[0].clientY,r.endX=e.originalEvent.targetTouches[0].clientX,r.endY=e.originalEvent.targetTouches[0].clientY,r.moved=!1},touchmove:function(e){r.endX=e.originalEvent.targetTouches[0].clientX,r.endY=e.originalEvent.targetTouches[0].clientY,a()||(r.moved=!0)}}),i.on("change","."+i.set.groupClass+" select.filterControls-value",function(t){t.preventDefault();var a=e(this).closest("."+i.set.groupClass).data("type"),r=e(this).closest("."+i.set.groupClass).attr("id"),l=e(this).val();"sort"!==r&&(i.set.latestCat=r),s.updateFilterObj.apply(i,[a,r,l])}),i.on("click touchend","."+i.set.groupClass+" a.filterControls-value",function(t){if(t.preventDefault(),i.set.touch!==!0||a()!==!1){var r=e(this).closest("."+i.set.groupClass).data("type"),l=e(this).closest("."+i.set.groupClass).attr("id"),n=e(this).data("value");"s"!==r?i.set.latestCat=l:e(this).hasClass("selected")||e(this).hasClass(i.set.disabledClass)||e(this).closest("."+i.set.groupClass).find(".filterControls-value").removeClass(i.set.selectedClass),e(this).hasClass(i.set.disabledClass)||e(this).parent().hasClass(i.set.disabledClass)||(i.set.allowNullS1?e(this).toggleClass(i.set.selectedClass):e(this).addClass(i.set.selectedClass),s.updateFilterObj.apply(i,[r,l,n]))}}),i.on("click touchend",".js-removeElement",function(t){if(t.preventDefault(),i.set.touch!==!0||a()!==!1){var r=e(this).find("a").data();type=r.type,cat=r.cat,val=r.value,"fakeSelect"===e("#"+cat).data("create")&&e("#"+cat+"-"+val).parent().trigger("click"),s.updateFilterObj.apply(i,[type,cat,val])}}),i.on("click touchend",".js-remove",function(t){if(t.preventDefault(),i.set.touch!==!0||a()!==!1){var r,l,n,o=e(this).closest("."+i.set.groupClass);0===o.length&&(o=e(this).siblings("."+i.set.groupClass)),r=o.data("type"),l=o.attr("id"),n="remove",o.find("."+i.set.selectedClass).removeClass(i.set.selectedClass),o.find("select").find("option").removeAttr("disabled").filter(":selected").removeAttr("selected"),s.updateFilterObj.apply(i,[r,l,n])}}),i.on("click touchend",".js-removeAll",function(r){if(r.preventDefault(),i.set.touch!==!0||a()!==!1){var l=e(t).scrollTop();i.set.filteredBy={},i.set.filteredBy.page=1,i.set.currentHash="",i.set.outputChosenFiltersId!==!1&&e("#"+i.set.outputChosenFiltersId).find("#js-refiltElements").remove(),i.set.updateLocation&&(i.set.currentHash=s.writeLocation(i.set.filteredBy)),e(t).scrollTop(l),i.find("."+i.set.groupClass).each(function(){"fakeSelect"===e(this).data("create")&&e(this).find(".fake-select").trigger("rekaf.resetSelect")}),i.find("."+i.set.groupClass+" ."+i.set.selectedClass).removeClass(i.set.selectedClass),i.find("."+i.set.groupClass+" option").removeAttr("disabled").filter(":selected").removeAttr("selected"),void 0!==i.set.onFilterChanged&&i.set.onFilterChanged(i.set.filteredBy,i),i.set.historyCategories||s.gatherItems.apply(i)}}),i.on("click touchend","."+i.set.paging.nextBtnClass,function(e){return e.preventDefault(),i.set.touch!==!0||a()!==!1?(i.set.filteredBy.page<i.set.pages&&(i.set.filteredBy.page+=1,i.set.updateLocation&&(i.set.currentHash=s.writeLocation(i.set.filteredBy)),i.find("."+i.set.pageCurrentClass).text(i.set.filteredBy.page),i.set.historyCategories||s.gatherItems.apply(i)),!1):void 0}),i.on("click touchend","."+i.set.paging.prevBtnClass,function(r){if(r.preventDefault(),i.set.touch!==!0||a()!==!1){var l=e(t).scrollTop();i.set.filteredBy.page>1&&(i.set.filteredBy.page-=1,i.set.updateLocation&&(i.set.currentHash=s.writeLocation(i.set.filteredBy)),e(t).scrollTop(l),i.find("."+i.set.pageCurrentClass).text(i.set.filteredBy.page),i.set.historyCategories||s.gatherItems.apply(i))}}),i.on("click touchend","."+i.set.paging.allBtnClass,function(t){if(t.preventDefault(),i.set.touch!==!0||a()!==!1){var r=e(this).closest("."+i.set.paging.contClass);r.hasClass("viewing-all")?(i.set.limit=i.set.oldLimit,r.removeClass("viewing-all"),i.find("."+i.set.pageCurrentClass).text(i.set.filteredBy.page)):(i.set.oldLimit=i.set.limit,i.set.limit="none",r.addClass("viewing-all"),i.find("."+i.set.pageCurrentClass).text(1)),s.gatherItems.apply(i)}})},reSelectLatestFilter:function(){var e=this;for(var t in e.set.filteredBy)if("page"!==t&&"sort"!==t){e.set.latestCat=t,e.set.resetLatestCat=!0;break}},createChosenElements:function(){var t=this,s=t.set.filteredBy,i='<div id="js-refiltElements">',a=function(t,s,i){var a=e("#"+t+"-"+s),r=void 0!==a.attr("title")?' title="'+a.attr("title")+'"':"";return a.length>0?"A"===a[0].nodeName?'<span class="js-removeElement"'+r+">"+a.parent().clone().children().removeAttr("id").attr({"data-type":i,"data-cat":t}).parent().html()+"</span>":'<span class="js-removeElement"><a href="#" data-type="'+i+'" data-cat="'+t+'" data-value="'+s+'">'+s+"</a></span>":void 0};for(var r in s)if("page"!==r&&"sort"!==r)if("sor"===s[r].type||"sand"===s[r].type)for(var l=0;l<s[r].value.length;l++)i+=a(r,s[r].value[l],s[r].type);else i+=a(r,s[r].value,s[r].type);i+="</div>",e("#"+t.set.outputChosenFiltersId).find("#js-refiltElements").remove(),e("#"+t.set.outputChosenFiltersId).append(i)},updateFilterObjFromHash:function(e){$this=e.data.this,init=e.data.init,$this.set.currentHash=t.location.hash,$this.set.preFilter&&init?$this.set.filteredBy=$this.set.preFilter:$this.set.preFilter||($this.set.filteredBy=s.readLocation.apply($this));var i=Object.keys($this.set.filteredBy).length>1||$this.set.filteredBy.page>1,a=init&&$this.set.preSort!==!1,r=init&&$this.set.debug||(init&&void 0!==$this.set.customRender)===!0,l=init&&""!==$this.set.currentHash;if(i){if($this.set.filteredBy.page>1&&($this.find("."+$this.set.paging.prevBtnClass).removeClass("."+$this.set.disabledClass),$this.set.initialLoad=!0),(!init||l||a||r)&&s.gatherItems.apply($this),$this.set.outputChosenFiltersId!==!1&&s.createChosenElements.apply($this),s.reSelect.apply($this),$this.set.historyCategories&&init){var n=s.gatherItems.apply($this,[!0]),o=Object.keys($this.set.filteredBy).reduce(function(e,t){return"sort"!==t&&"page"!==t?e+1:e},0);s.updateFilterHTML.apply($this,[o,n,$this.set.relevantFilters||$this.filter.filter])}}else init?$this.set.preSort!==!1?s.gatherItems.apply($this):($this.set.debug===!0||void 0!==$this.set.customRender)&&s.gatherItems.apply($this):s.gatherItems.apply($this);void 0!==$this.set.onFilterChanged&&$this.set.onFilterChanged($this.set.filteredBy,$this)},updateFilterObj:function(i,a,r){var l=this,n=null,o=null,d=0;"s1"===i||"s"===i?(n=void 0!==l.set.filteredBy[a]?"object"==typeof l.set.filteredBy[a].value?l.set.filteredBy[a].value.join(","):l.set.filteredBy[a].value:"",n===r&&l.set.allowNullS1||"remove"===r?(delete l.set.filteredBy[a],s.reSelectLatestFilter.apply(l)):l.set.filteredBy[a]={type:i,value:r}):("sand"===i||"sor"===i)&&("remove"===r?void 0!==l.set.filteredBy[a]&&(delete l.set.filteredBy[a],s.reSelectLatestFilter.apply(l)):null===r?(delete l.set.filteredBy[a],s.reSelectLatestFilter.apply(l)):"object"==typeof r?r.length>0&&(l.set.filteredBy[a]={type:i,value:r}):(r+="",n=void 0!==l.set.filteredBy[a]&&void 0!==l.set.filteredBy[a].value?l.set.filteredBy[a].value:[],o=e.inArray(r,n),-1!==o?n.splice(o,1):n.push(r),n.length>0?l.set.filteredBy[a]={type:i,value:n}:(delete l.set.filteredBy[a],s.reSelectLatestFilter.apply(l)))),l.set.debug===!0&&console.log("var $this.set.filteredBy",l.set.filteredBy),l.set.outputChosenFiltersId!==!1&&s.createChosenElements.apply(l),l.set.filteredBy.page=1,d=e(t).scrollTop(),l.set.updateLocation?l.set.currentHash=s.writeLocation(l.set.filteredBy):s.updateFilterObjFromHash({data:{"this":l,init:!1}}),1===Object.keys(l.set.filteredBy).length&&e(t).scrollTop(d),l.set.updateLocation&&l.set.updateWHash!==!1&&e("."+l.set.updateWHash).each(function(){var t=e(this).attr("href");e(this).attr("href",t+"#"+l.set.currentHash)})},reSelect:function(){var t,s,i=this,a=i.set.filteredBy,r={},l={},n="",o="",d=i.filter.settings.filter.slice(),c=function(){var t,s=[];return i.find("."+i.set.groupClass).each(function(){-1!==e(this).attr("id").indexOf("categories")&&s.push("#"+e(this).attr("id"))}),t=i.find(s.join(","))};d.push(["sort"]);for(t in d){if("page"===t)return;t=d[t][0],s=t.replace(/\//g,"-"),a[t]||(r=i.find("#"+s),0===r.length&&-1!==s.indexOf("categories")&&(r=c()),r.find("."+i.set.selectedClass+", option[selected=selected]").removeClass(i.set.selectedClass).removeAttr("selected"))}for(t in a){if("page"===t)return;if(s=t.replace(/\//g,"-"),r=i.find("#"+s),0===r.length&&-1!==s.indexOf("categories")&&(r=c()),n=a[t].value,o=r.data("create"),0!==r.length)if("sort"===t&&(n=a[t].value.join("-")),"object"==typeof a[t].value&&"sort"!==t){"select"===o||"multiSelect"===o?r.find("option").removeAttr("selected"):"fakeSelect"===o?r.find("li."+i.set.selectedClass).removeClass(i.set.selectedClass):r.find("."+i.set.selectedClass).removeClass(i.set.selectedClass);for(var p=0;p<a[t].value.length;p++)n=a[t].value[p].replace(/\W/g,"-"),"select"===o||"multiSelect"===o?r.find("#"+s+"-"+n).attr("selected",!0):"fakeSelect"===o?r.find("#"+s+"-"+n).closest("li").addClass(i.set.selectedClass):r.find("#"+s+"-"+n).addClass(i.set.selectedClass)}else"select"===o||"multiSelect"===o?r.find("option").removeAttr("selected"):"fakeSelect"===o?(r.find(".selected").removeClass("selected"),r.find("."+i.set.selectedClass).removeClass(i.set.selectedClass)):r.find("."+i.set.selectedClass).removeClass(i.set.selectedClass),l=r.find("#"+s+"-"+n.replace(/\W/g,"-")),"select"===o||"multiSelect"===o?l.attr("selected",!0):"fakeSelect"===o?(l.closest("li").addClass(i.set.selectedClass),r.find(".fake-select").addClass("selected").find("span").text(l.text())):l.addClass(i.set.selectedClass)}void 0!==i.set.onFilterChanged&&i.set.onFilterChanged(i.set.filteredBy,i)},gatherItems:function(e,t){var i=this,a=/_\d$/,r=i.set.relevantFilters||i.filter.filter,l=0,n=0,o=[],d=[],c=[],p=[];t=t||i.set.filteredBy,e=e||!1;var f=function(e,t){var s=[],l=0,n=parseInt(e.slice(-1),10)-1,o=e.replace(a,""),d=t===i.set.undefinedCatId?void 0:t;for(var c in r[o])(0===c.indexOf(i.set.category)||i.set.isCampaignURL)&&d===c.split("/")[n]&&(s[l]=r[o][c],l++);return Array.prototype.concat.apply([],s)};for(var u in t)if("page"!==u&&"sort"!==u){if("s1"===t[u].type)d=a.test(u)?f(u,t[u].value):r[u][Array.isArray(t[u].value)?t[u].value[0]:t[u].value];else if("sor"===t[u].type){for(p=t[u].value.slice(0),i.set.historyCategories&&0===u.indexOf("categories")&&-1===i.set.currentHash.indexOf("categories")||p.reverse(),n=0;n<p.length;n++)o[n]=a.test(u)?f(u,p[n]):r[u][p[n]];d=Array.prototype.concat.apply([],o)}else if("sand"===t[u].type)for(n=0;n<t[u].value.length;n++)o[n]=r[u][t[u].value[n]],d=d;c=0===l?d:s.intersect(c,d),o=[],l++}return e?c:(l>0?i.addClass("refilt--filtered"):i.removeClass("refilt--filtered"),s.updateFilterHTML.apply(i,[l,c,r]),c.length>0?(c=s.unique(c),i.set.currentItems=void 0!==i.filter.related?s.relatedToItems.apply(i,[c,!1]):s.keysToItems.apply(i,[c])):i.set.currentItems=JSON.parse(i.set.initItemsStr),s.sortOrRenderItems.apply(i),void 0)},updateFilterHTML:function(t,a,r){var l,n,o,d,c,p,f,u,h,g,v,m,y,C=this,b=C.filter.settings.filter,I={},S={},w=function(){var t,s=[];return C.find("."+C.set.groupClass).each(function(){-1!==e(this).attr("id").indexOf("categories")&&s.push("#"+e(this).attr("id"))}),t=C.find(s.join(","))};if(0===t||void 0===a)for(C.set.currentItems=JSON.parse(C.set.initItemsStr),C.find("."+C.set.groupClass).removeClass(C.set.disabledClass).find("."+C.set.disabledClass+", ."+C.set.selectedClass).removeClass(C.set.disabledClass+" "+C.set.selectedClass),C.find("."+C.set.groupClass+" option").removeAttr("disabled").filter(":selected").removeAttr("selected"),i=0;i<b.length;i++)I=C.find("#"+b[i][0]),p=I.data("max-length")||null,null!==p&&Object.keys(r[b[i][0]]).length>p&&(C.set.hideAncestor!==!1?I.closest("."+C.set.hideAncestor).addClass("too-many-options"):I.addClass("too-many-options"));else for(i=0;i<b.length;i++)if(I=C.find("#"+b[i][0]),0===I.length&&-1!==b[i][0].indexOf("categories")&&(I=w()),c=I.data("type")||null,n=b[i][0].replace(/_\d$/,""),C.set.latestCat!==n||1!==t){if(l=0,o=0,d=I.data("create")||null,p=I.data("max-length")||null,g=I.data("depth")-1||null,f="",u={},h=r[n],intersected=[],m=a.slice(),null!==g){for(v in r[n]){var x=[],O=v.split("/");void 0!==O[g]&&(F=O[g],x=void 0===u[F]?[]:u[F],u[F]=Array.prototype.concat.apply(x,r[n][v]))}h=u}void 0!==C.set.filteredBy[b[i][0]]&&(y=e.extend(!0,{},C.set.filteredBy),delete y[b[i][0]],newGatheredItems=s.gatherItems.apply(C,[!0,y]),m=Array.prototype.concat.apply(m,newGatheredItems),m=s.unique(m));for(v in h){var F=v.replace(/\W/g,"-");intersected=s.intersect(m,h[v]),S=C.find("#"+n+"-"+F),0!==S.length&&(f=S.prop("tagName").toLowerCase(),intersected.length>0?("option"===f||"input"===f?S.removeAttr("disabled"):"fakeSelect"===d?S.closest("li").removeClass(C.set.disabledClass):S.removeClass(C.set.disabledClass),o+=intersected.length,l++):"option"===f||"input"===f?S.attr("disabled",!0):"fakeSelect"===d?S.closest("li").addClass(C.set.disabledClass):S.addClass(C.set.disabledClass))}null!==p&&(l>p?C.set.hideAncestor!==!1?I.closest("."+C.set.hideAncestor).addClass("too-many-options"):I.addClass("too-many-options"):C.set.hideAncestor!==!1?I.closest("."+C.set.hideAncestor).removeClass("too-many-options"):I.removeClass("too-many-options")),l>0?I.removeClass(C.set.disabledClass):I.addClass(C.set.disabledClass)}else C.set.resetLatestCat&&(e("#"+b[i][0]).find("."+C.set.disabledClass).removeClass(C.set.disabledClass),e("#"+b[i][0]).find("option").removeAttr("disabled"),C.set.resetLatestCat=!1)},sortOrRenderItems:function(){var e=this;void 0!==e.set.filteredBy.sort&&e.set.currentItems.length>0?s.sortItems.apply(e):e.set.preSort!==!1?s.sortItems.apply(e,[e.set.preSort[0],e.set.preSort[1]]):s.renderItems.apply(e)},sortItems:function(e,t){var i=this,a=i.set.currentItems,r=a.length,l=e||i.set.filteredBy.sort.value[0],n=e&&t?e+"-"+t:i.set.filteredBy.sort.value.join("-"),o=t||i.set.filteredBy.sort.value[1],d=0,c=0,p=0,f=[],u={};for(d=0;r>d;d++)f[d]={obj:a[d]},void 0!==i.filter.related&&a[d].relatedShowMain===!1?(related=s.keysToItems.apply(i,[a[d].relatedShowVariants]),u=related[0]):u=a[d],"price"===l?(p=parseFloat(u.price.priceAsNumber,10),u.price.soldout&&(p="dsc"===o?0:999999999),f[d][l]=p):f[d][l]="news"===l?u.price.newProduct?0:10:u[l],c++;for($item=i.find("#sort-"+n),"fakeSelect"===i.find("#sort").data("create")?$item.closest("li").addClass(i.set.selectedClass):$item.addClass(i.set.selectedClass),f.sort("number"==typeof f[0][l]?function(e,t){return e[l]-t[l]}:function(e,t){return e[l]<t[l]||""===t[l]?-1:e[l]>t[l]?1:0}),"dsc"===o&&f.reverse(),i.set.currentItems=[],d=0;r>d;d++)i.set.currentItems[d]=f[d].obj;s.renderItems.apply(i)},renderItems:function(){var t=this,i=t.set.currentItems,a=i.length,r=null,l=0,n="",o=[];t.set.renderOnly||(t.set.initialLoad?(l=t.set.appendItems?0:t.set.limit*(t.set.filteredBy.page-1),r=t.set.limit*t.set.filteredBy.page,a=r>a?a:r,t.set.filteredBy.page>1&&t.find("."+t.set.paging.prevBtnClass).removeClass(t.set.disabledClass),a!==r&&t.find("."+t.set.paging.nextBtnClass).addClass(t.set.disabledClass)):"none"!==t.set.limit?a>t.set.limit?(t.set.pages=Math.ceil(a/t.set.limit),r=t.set.limit*t.set.filteredBy.page,l=(t.set.filteredBy.page-1)*t.set.limit,a=r>a?a:r,t.set.filteredBy.page>1?t.find("."+t.set.paging.prevBtnClass).removeClass(t.set.disabledClass):t.find("."+t.set.paging.prevBtnClass).addClass(t.set.disabledClass),a!==r?t.find("."+t.set.paging.nextBtnClass).addClass(t.set.disabledClass):t.find("."+t.set.paging.nextBtnClass).removeClass(t.set.disabledClass)):(t.set.pages=1,t.find("."+t.set.paging.contClass).addClass(t.set.disabledClass)):(t.set.pages=1,t.find("."+t.set.paging.nextBtnClass+",."+t.set.paging.prevBtnClass).addClass(t.set.disabledClass))),t.find("."+t.set.pageTotalClass).text(t.set.pages),t.find("."+t.set.itemTotalClass).text(i.length),t.find("."+t.set.allItemsTotalClass).text(t.set.currentItems.length),t.find("."+t.set.currentTotalClass).text(a);for(var d=l;a>d;d++)t.set.eachItemAttrs&&(i[d]=t.set.eachItemAttrs(t,i[d],d)),t.set.onItemIndex===d&&(n+=t.set.onItem(a)),void 0!==t.set.customRender?o[o.length]={html:s.renderItemTemplate.apply(t,[i[d]]),item:i[d]}:n+=s.renderItemTemplate.apply(t,[i[d]]);t.set.appendItems&&1!==t.set.pages&&1!==t.set.filteredBy.page&&t.set.initialLoad===!1?(void 0!==t.set.beforeItemsRendered&&t.set.beforeItemsRendered("append"),void 0!==t.set.customRender?t.set.customRender("append",t.filter,o,t.set.filteredBy):t.find("#"+t.set.itemContId).append(n)):(void 0!==t.set.beforeItemsRendered&&t.set.beforeItemsRendered("replace"),void 0!==t.set.customRender?t.set.customRender("replace",t.filter,o,t.set.filteredBy):t.find("#"+t.set.itemContId).html(n)),(void 0===t.set.appendHashValue||t.set.appendHashValue)&&(hash=-1===t.set.currentHash.indexOf("#")?"#"+t.set.currentHash:t.set.currentHash,t.find("#"+t.set.itemContId+" a").each(function(){var t=e(this).attr("href");-1!==t.indexOf("#")&&(t=t.substring(0,t.indexOf("#"))),e(this).attr("href",t+hash)})),t.set.initialLoad=!1,void 0!==t.set.afterItemsRendered&&t.set.afterItemsRendered()},renderItemTemplate:function(t){var i=this,a=i.filter.settings.template.item,r=i.filter.settings.template.price,l=i.filter.settings.template.related,n=i.filter.settings.template.attribute,o="",d="",c={},p=[],f={},u=!0;if(void 0!==i.filter.related&&t.relatedShowMain===!1?(p=s.keysToItems.apply(i,[t.relatedShowVariants]),f=e.extend({},p[0])):f=e.extend({},t),void 0!==l){void 0!==t.related&&t.related.length>0&&(p=s.keysToItems.apply(i,[t.related]));for(d in l){"swatch"===d&&null!==t.swatch&&(u=!t.relatedShowMain,o+=s.renderItemReplace.apply(i,[t,l[d],{idPrefix:t.id+"_",relatedHide:u}]));for(var h=0;h<p.length;h++)if(void 0!==p[h]){if(u=!0,void 0!==i.filter.related&&void 0!==t.relatedShowVariants)for(var g=0;g<t.relatedShowVariants.length;g++)if(t.relatedShowVariants[g]===p[h].id){u=!1;break}void 0!==r&&-1!==l[d].indexOf("{price}")&&"object"==typeof p[h].price&&(p[h].price=s.renderItemPrice.apply(i,[p[h],r])),o+=s.renderItemReplace.apply(i,[p[h],l[d],{idPrefix:t.id+"_",relatedHide:u}])}""!==o&&(f["related_"+d]=o),o=""}}if(void 0!==n)for(d in n){o="";for(var v in f[d])c=e.extend({},f),c[d]=f[d][v],o+=s.renderItemReplace.apply(i,[c,n[d],{}]);f["attribute_"+d]=o}return void 0!==r&&"object"==typeof f.price&&(f.price=s.renderItemPrice.apply(i,[f,r])),a=s.renderItemReplace.apply(i,[f,a,{finalReplace:!0}])},renderItemPrice:function(e,t){var s=this,i="",a="object"==typeof e.price;return a&&0===e.price.priceAsNumber&&!s.set.showZeroPrices?"":(a&&e.price.special&&t.special?(i=t.special,e.classProductNew=e.price.newProduct===!0?" "+s.set.classProductNew:"",e.classProductSale=e.price.showAsOnSale===!0?" "+s.set.classProductSale:""):a&&e.price.soldout&&t.soldout?i=t.soldout:(i=a&&e.price.showAsOnSale&&t.discounted?t.discounted:a&&e.price.newProduct&&t.news?t.news:t.default,e.classProductNew=e.price.newProduct===!0?" "+s.set.classProductNew:"",e.classProductSale=e.price.showAsOnSale===!0?" "+s.set.classProductSale:""),i=i.replace(/\{(.+?)\}/g,function(t,s){return void 0===e.price[s]?"":e.price[s]}))},renderItemReplace:function(e,i,a){var r,l=this,n=!1,o=a.finalReplace||!1;return e.image="object"==typeof e.image?e.image:[e.image],e.hash=-1===l.set.currentHash.indexOf("#")?"#"+l.set.currentHash:l.set.currentHash,e.root=encodeURIComponent(t.location.origin),e.locale=s.getLocale(),(l.set.isCampaignURL||l.set.renderOnly)&&e.canonicalUri?(r=e.canonicalUri.split("/"),r.pop(),e.category=r.join("/")):e.category=l.set.category,i=i.replace(/\{(.+?)\}/g,function(t,i){var r,d="",c="",p="",f=[];if("image_"===i.substring(0,6)){if(r=parseInt(i.substring(6))-1,d=e.image[r],void 0===d||null===d)return n=!0,"{#}"}else if("attribute_"!==i.substring(0,10)||o)if(-1!==i.indexOf("|"))switch(i=i.split("|"),i[1]){case"title":d=void 0!==e[i[0]]?s.titleCase(e[i[0]]):""}else d="relatedHide"===i&&void 0!==a.relatedHide?a.relatedHide?l.set.disabledClass:"":"id"===i&&void 0!==a.idPrefix?a.idPrefix+e[i]:void 0!==e[i]?e[i]:"";else f=i.split("_"),c=f[1],p=f.length>2?f[2]:"",null!==e[c]&&"object"==typeof e[c]&&void 0!==e[c].desc&&(d=s.hexOrImage(e[c],p,l.set.forceHex,l.set.swatchClass));return d}),n&&(i=i.replace(/<[^<]*\{#\}[^>]*>/g,"")),i},hexOrImage:function(e,t,s,i){var a="";return void 0===e.image||void 0===e.image.url||s?void 0!==e.hex&&e.hex.replace(/#?([a-f,0-9]{3,6})/gi,function(t,s){a+='<span data-value="'+e.desc+'" class="'+i+'" style="background-color: #'+s+';"></span>'}):a="style"===t?'<span data-value="'+e.desc+'" class="'+i+'" style="background-image: url('+e.image.url+');"></span>':e.image.url,a},relatedToItems:function(e,t){var s=this,i={},a=[],r={},l=[],n="",o=[],d="",c=0;for(c=0;c<e.length;c++)-1!==e[c].indexOf("_")?(o=e[c].split("_"),void 0===r[o[0]]?r[o[0]]={relatedShowVariants:[o[1]]}:r[o[0]].relatedShowVariants.push(o[1])):(i[e[c]]={relatedShowMain:!0},a[a.length]=e[c]);for(d in r)void 0!==i[d]?i[d].relatedShowVariants=r[d].relatedShowVariants:t||(i[d]=r[d],i[d].relatedShowMain=!1,a[a.length]=d);for(c=0;c<a.length;c++)n=s.filter.productIds[a[c]],l[c]=s.filter.products[n],l[c].relatedShowMain=i[a[c]].relatedShowMain,l[c].relatedShowVariants=i[a[c]].relatedShowVariants;return l},keysToItems:function(e){for(var t=this,s=[],i="",a=0;a<e.length;a++)i=t.filter.productIds[e[a]],void 0!==i&&(s[s.length]=t.filter.products[i]);return s},unique:function(e){var t=[];e:for(var s=0;s<e.length;s++){for(var i=0;i<t.length;i++)if(t[i]==e[s])continue e;t[t.length]=e[s]}return t},intersect:function(e,t){var s=[],i={},a=0;for(a=0;a<e.length;a++)i[e[a]]=!0;for(a=0;a<t.length;a++)i[t[a]]&&(s[s.length]=t[a]);return s},readLocation:function(){var i=this,a=t.location.hash,r={},l=a.substring(1).split("&"),n=[],o="",d=[],c={},p={},f=!0;if(a.length>1&&1!==a.indexOf("/"))for(var u=0;u<l.length;u++)if(n=l[u].split("="),"page"===n[0])r.page=parseInt(n[1]);else if(0===n[0].indexOf("categories"))c[n[0].slice(0,n[0].indexOf("~"))]=n[1].split(",");else{switch(o=n[0].split("~"),o[1]){case"sand":d=n[1].split("+");
break;case"sor":case"r":case"s":case"f":d=n[1].split(",");break;default:d=n[1]}"sort"!==o[0]&&(i.set.latestCat=o[0]),r[o[0]]={type:o[1],value:d}}return i.set.historyCategories&&(Object.keys(i.set.filterCategories).forEach(function(e){i.set.filterCategories[e].forEach(function(t){-1!==t.indexOf(i.set.category)?(void 0===p[e]&&(p[e]=[]),p[e].push(t)):f=!1})}),0===Object.keys(p).length&&0===Object.keys(c).length||f||Object.keys(p).forEach(function(t){var a=e("#"+t).data("type"),l=[];void 0!==c[t]?(l=s.intersect(p[t],c[t]),delete c[t]):l=p[t],""===i.set.latestCat&&(i.set.latestCat=t),r[t]={type:a,value:l}}),0!==Object.keys(c).length&&Object.keys(c).forEach(function(t){var s=e("#"+t).data("type");""===i.set.latestCat&&(i.set.latestCat=t),r[t]={type:s,value:c[t]}})),void 0===r.page&&(r.page=1),r},writeLocation:function(e){var i="",a="",r="",l=null,n=t.location.href;for(var o in e)if("page"===o)e[o]>1&&(i+="page="+e[o]+"&");else if(0===o.indexOf("categories")&&$this.set.historyCategories){var d=e[o].value;Array.isArray(d)||(d=[d]),"s1"===e[o].type&&d.length>1&&(d=[d[0]]),1===d.length&&""===a?a=d[0]:i+=o+"~"+e[o].type+"="+d.join(",")+"&"}else{switch(e[o].type){case"sand":l=e[o].value.join("+");break;case"sor":case"s":case"r":case"f":l=e[o].value.join(",");break;default:l=e[o].value}i+=o+"~"+e[o].type+"="+l+"&"}return i=i.substring(0,i.length-1),$this.set.historyCategories?(a.length>0?(r=a,a=t.location.pathname.replace($this.set.category,"")+a):(r=-1!==$this.set.category.indexOf("/")?$this.set.category.slice(0,$this.set.category.indexOf("/")):$this.set.category,a=t.location.pathname.replace($this.set.category,"")+r),a=a.replace("//","/"),$this.set.category=r,""!==i&&(i="#"+i),history.pushState({},"",a+i),n!==t.location.href&&s.updateFilterObjFromHash({data:{"this":$this,init:!1}})):t.location.hash=i,i.length?i:""},titleCase:function(e){return e.toLowerCase().replace(/^\S|\s\S/g,function(e){return e.toUpperCase()})},getLocale:function(){var e=t.location.pathname.split("/")[1];return/\w/.test(e)?"/"+e:""},urlify:function(e){return e.toLowerCase().replace(/\s{2,}|\s/g,"-")}},a={init:function(i){var a=e.extend({},r,i);return t.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)}}(),this.each(function(){var t=e(this),i=t.data();t.set=e.extend({},a,i,l),t.set.debug===!0&&(console.warn(":::: YS Filter Debug has been set to true ::::"),console.log("Options -> ",t.set),void 0===t.set.url&&console.warn("No url has been defined i.e. loadproducts")),s.init.apply(t),t.data(t.set)})},renderProducts:function(t,i,a){var n=e.extend({},r,t);return this.each(function(){var t=e(this),r=s.unique(i.slice(0));t.set=e.extend({},l,n),t.filter=e.extend(!0,{},a),t.set.currentItems=s.keysToItems.apply(t,[r]),t.set.renderOnly=!0,t.filter.settings.limit>0&&(t.set.limit=t.filter.settings.limit),t.set.debug===!0&&console.log("DEBUG: LOAD $this.set.appendItems, $this.set.pages, $this.set.filteredBy.page, $this.set.initialLoad",t.set.appendItems,t.set.pages,t.set.filteredBy.page,t.set.initialLoad),s.renderItems.apply(t)})}},r={limit:20,preSort:!1,preFilter:!1,splitSizes:!1,appendItems:!1,multipleImgs:!1,filterOptions:{},paging:{contClass:"filterPaging",nextBtnClass:"filterPaging-next",prevBtnClass:"filterPaging-prev",allBtnClass:"filterPaging-all"},updateWHash:!1,hideAncestor:!1,repeatStartFakeSelect:!1,outputChosenFiltersId:!1,forceHex:!1,sortFiltersAlphabetically:!1,historyCategories:!1,filterProducts:!1,updateLocation:!0,allowNullS1:!0,newsURI:"new-arrivals",saleURI:"sale",undefinedCat:"Unsorted",undefinedCatId:"unsorted",itemContId:"filterItems",selectedClass:"u-selected",disabledClass:"u-disabled",groupClass:"filterControls-group",classProductNew:"product--new",classProductSale:"product--sale",pageTotalClass:"js-pages-total",pageCurrentClass:"js-pages-current",itemTotalClass:"js-items-total",allItemsTotalClass:"js-allItems-total",currentTotalClass:"js-items-current",swatchClass:"colorList-color",alsoMatchChildrenCategories:!1},l={filteredBy:{page:1},renderOnly:!1,filterCategories:{},currentHash:"",latestCat:"",resetLatestCat:!1,isCampaignURL:!1,currentItems:[],oldLimit:null,relevantFilters:null,initialLoad:!1,pages:1};e.fn.refilt=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.refilt"):a.init.apply(this,arguments)}});